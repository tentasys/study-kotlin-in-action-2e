# π“ 11μ¥ μ λ„¤λ¦­μ¤

## π“– 11.1 νƒ€μ… μΈμλ¥Ό λ°›λ” νƒ€μ… λ§λ“¤κΈ°: μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°

- μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ°›λ” νƒ€μ…μ„ μ •μν•  μ μλ‹¤.
- μ λ„¤λ¦­ νƒ€μ…μ μΈμ¤ν„΄μ¤κ°€ λ§λ“¤μ–΄μ§ λ•λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ μΉν™ν•λ‹¤.
- μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” λ³΄ν†µ νƒ€μ…κ³Ό λ§μ°¬κ°€μ§€λ΅ νƒ€μ… μΈμλ„ μ¶”λ΅ ν•  μ μλ‹¤.

```kotlin
val readers: MutableList<String> = mutableListOf()
val readers = mutableListOf<String>()
```

- μ„ λ‘ μ„ μ–Έμ€ λ™λ“±ν•λ‹¤.
- λΉ λ¦¬μ¤νΈλ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ‹¤λ©΄ νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  κ·Όκ±°κ°€ μ—†κΈ°μ— μ§μ ‘ λ…μ‹ν•΄μ•Ό ν•λ‹¤.
- μ½”ν‹€λ¦°μ—λ” raw νƒ€μ…μ΄ μ—†λ‹¤.

### π”– 11.1.1 μ λ„¤λ¦­ νƒ€μ…κ³Ό ν•¨κ» λ™μ‘ν•λ” ν•¨μμ™€ ν”„λ΅νΌν‹°

- μ λ„¤λ¦­ ν•¨μλ¥Ό νΈμ¶ν•  λ•λ” λ°λ“μ‹ κµ¬μ²΄μ  νƒ€μ…μΌλ΅ νƒ€μ…μΈμλ¥Ό λ„κ²¨μ•Ό ν•λ‹¤.
- ν•¨μμ νƒ€μ… νλΌλ―Έν„° Tκ°€ μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ…μ— μ“°μΈλ‹¤.

```kotlin
fun main() {
    val letters = ('a'..'z').toList()
    println(letters.slice<Char>(0..2))
    println(letters.slice(10..13))
}
```

- μ»΄νμΌλ¬λ” νƒ€μ…μ„ μ¶”λ΅ ν•λ‹¤.

```kotlin
fun main() {
    val authors = listOf("Sveta", "Seb", "Roman", "Dima")
    val readers = mutableListOf<String>("Seb", "Hadi")
    println(readers.filter { it !in authors })
}
```
- itμ νƒ€μ…μ€ `String`μ΄λ‹¤.
- μ»΄νμΌλ¬λ” `filter`κ°€ `List<T>`νƒ€μ…μ λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶λ  μ μλ‹¤λ” μ‚¬μ‹¤κ³Ό `filter`μ μμ‹  κ°μ²΄μΈ `reader`μ μ‹¤μ  νƒ€μ…μ΄ `List<String>`μ΄λΌλ” μ‚¬μ‹¤μ„ μ•κ³  κ·Έλ΅λ¶€ν„° μ¶”λ΅ ν•λ‹¤.
- μΌλ° ν”„λ΅νΌν‹°λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κ°€μ§ μ μ—†μ§€λ§ ν™•μ¥ ν”„λ΅νΌν‹°λ” κ°€μ§ μ μλ‹¤.

### π”– 11.1.2 μ λ„¤λ¦­ ν΄λμ¤λ¥Ό ν™‘ν™”μ‚΄κ΄„νΈ κµ¬λ¬Έμ„ μ‚¬μ©ν•΄ μ„ μ–Έν•λ‹¤.

- μ λ„¤λ¦­ ν΄λμ¤λ¥Ό ν™•μ¥ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ ¤λ©΄ κΈ°λ° νƒ€μ…μ μ λ„¤λ¦­ νλΌλ―Έν„°μ— λ€ν•΄ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤.

```kotlin
class StringList : List<String> {
    override fun get(index: Int): String = TODO()
}

class ArrayList<T> : List<T> {
    override fun get(index: Int): T = TODO()
}
```

- ν•μ„ ν΄λμ¤μ—μ„ μƒμ„ ν΄λμ¤μ— μ •μλ ν•¨μλ¥Ό μ¤λ²„λΌμ΄λ“ν•κ±°λ‚ μ‚¬μ©ν•λ ¤λ©΄ νƒ€μ… μΈμ Tλ¥Ό κµ¬μ²΄μ  νƒ€μ… `String`μΌλ΅ μΉν™ν•΄μ•Ό ν•λ‹¤.
- `ArrayList` ν΄λμ¤λ” μμ‹ λ§μ νƒ€μ… νλΌλ―Έν„° Tλ¥Ό μ •μν•λ©΄μ„ κ·Έ Tλ¥Ό κΈ°λ° ν΄λμ¤μ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•λ‹¤.
- ν΄λμ¤κ°€ μμ‹ μ„ νƒ€μ… μΈμλ΅ μ°Έμ΅°ν•  μλ„ μλ‹¤.

### π”– 11.1.3 μ λ„¤λ¦­ ν΄λμ¤λ‚ ν•¨μκ°€ μ‚¬μ©ν•  μ μλ” νƒ€μ… μ ν•: νƒ€μ… νλΌλ―Έν„° μ μ•½

```kotlin
fun <T: Number> oneHalf(value: T): Double {
    return value.toDouble()
}
```

- νƒ€μ… νλΌλ―Έν„° μ μ•½μ€ ν΄λμ¤λ‚ ν•¨μμ— μ‚¬μ©ν•  μ μλ” νƒ€μ… μΈμλ¥Ό μ ν•ν•λ” κΈ°λ¥
- μ–΄λ–¤ νƒ€μ…μ„ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• **μƒκ³„**λ΅ μ§€μ •ν•λ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• μ‚¬μ©ν•λ” νƒ€μ… μΈμλ” λ°λ“μ‹ κ·Έ μƒκ³„ νƒ€μ…μ΄κ±°λ‚ κ·Έ μƒκ³„ νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.
- μ μ•½μ„ κ°€ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ λ’¤μ— μ½λ΅ (:)μ„ ν‘μ‹ν•κ³  κ·Έ λ’¤μ— μƒκ³„ νƒ€μ…μ„ μ μΌλ©΄ λλ‹¤.

```kotlin
fun <T: Comparable<T>> max(first: T, second: T): T {
    return if (first > second) first else second
}

fun main() {
    println(max("kotlin", "java"))
    // kotlin
}
```

- `max`λ¥Ό λΉ„κµν•  μ μ—†λ” κ°’ μ‚¬μ΄μ— νΈμ¶ν•λ©΄ μ»΄νμΌ μ¤λ¥ λ°μƒ

```kotlin
fun <T> ensureTrailingPeriod(seq: T) where T: CharSequence, T: Appendable {
    if (!seq.endsWith('.')) {
        seq.append('.')
    }
}
```

- νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ λ‘ μ΄μƒμ μ μ•½μ„ κ°€ν•΄μ•Όν•λ” κ²½μ°

### π”– 11.1.4 λ…μ‹μ μΌλ΅ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν‘μ‹ν•΄μ„ λ„μ΄ λ  μ μλ” νƒ€μ… μΈμ μ μ™Έμ‹ν‚¤κΈ°

```kotlin
class Processor<T> {
    fun process(value: T) {
        value?.hashCode()
    }
}
```

- μ•„λ¬΄λ° μƒκ³„λ¥Ό μ •ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ” `Any?`λ¥Ό μƒκ³„λ΅ μ •ν• νλΌλ―Έν„°μ™€ κ°™λ‹¤.
- T νƒ€μ…μ΄ λ„μ΄ λ  μ μλ” νƒ€μ…μ΄ λμ§€ λ»ν•κ² λ§‰λ” μ•„λ¬΄λ° μ μ•½μ΄ μ—†κΈ° λ•

```kotlin
class Processor<T: Any> {
    fun process(value: T) {
        value.hashCode()
    }
}
```

- ν•­μƒ λ„μ΄ λ  μ μ—†λ” νƒ€μ…λ§ νƒ€μ… μΈμλ΅ λ°›κ² λ§λ“¤λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„°μ— μ μ•½μ„ κ°€ν•΄μ•Ό ν•λ‹¤.

## π“– 11.2 μ‹¤ν–‰ μ‹μ  μ λ„¤λ¦­μ¤ λ™μ‘: μ†κ±°λ νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°

- JVMμ μ λ„¤λ¦­μ¤λ” λ³΄ν†µ **νƒ€μ…μ†κ±°**λ¥Ό μ‚¬μ©ν•΄ κµ¬ν„λλ‹¤.
  - μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— νƒ€μ… μΈμ μ •λ³΄κ°€ λ“¤μ–΄μμ§€ μ•λ‹¤.

### π”– 11.2.1 μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… μ •λ³΄λ¥Ό μ°Ύμ„ λ• ν•κ³„: νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν…

- μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ½”ν‹€λ¦° μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄λ” λ°νƒ€μ„μ— μ§€μ›μ§„λ‹¤.

#### π› οΈ νƒ€μ… μ†κ±°λ΅ μΈν•΄ μƒκΈ°λ” ν•κ³„

- νƒ€μ… μΈμλ¥Ό λ”°λ΅ μ €μ¥ν•μ§€ μ•κΈ° λ•λ¬Έμ— μ‹¤ν–‰ μ‹μ μ— νƒ€μ… μΈμλ¥Ό κ²€μ‚¬ν•  μ μ—†λ‹¤.
- μ½”ν‹€λ¦°μ—μ„ νλΌλ―Έν„°μ νƒ€μ… μΈμμ— λ”°λΌ μ„λ΅ λ‹¤λ¥Έ λ™μ‘μ„ ν•΄μ•Ό ν•λ” ν•¨μλ¥Ό μ‘μ„±ν•  λ• λ¬Έμ κ°€ λλ‹¤.

```kotlin
fun readNumbersOrWords(): List<Any> {
    val input = readln()
    val words: List<String> = input.split(",")
    val numbers: List<Int> = words.mapNotNull { it.toIntOrNull() }
    return numbers.ifEmpty { words }
}

fun printList(l: List<Any>) {
    when(1) {
        is List<String> -> println("Strings: $l") // error
        is List<Int> -> println("Integers: $l") // error
    }
}
```

- μ‹¤ν–‰ μ‹μ μ— μ–΄λ–¤ κ°’μ΄ `List`μΈμ§€ μ—¬λ¶€λ” ν™•μ‹¤ν μ•μ•„λ‚Ό μ μμ§€λ§ κ·Έ λ¦¬μ¤νΈκ°€ λ¬Έμμ—΄, μ‚¬λ λ“± μ‹¤μ  μ–΄λ–¤ νƒ€μ…μ μ›μ†κ°€ λ“¤μ–΄μλ” λ¦¬μ¤νΈμΈμ§€λ” μ• μ μ—†λ‹¤.

```kotlin
fun printSum(c: Collection<*>) {
    val intList = c as? List<Int> ?: throw IllegalArgumentException("List is expected")
    println(intList.sum())
}
```

- μΈμλ¥Ό μ• μ μ—†λ” μ λ„¤λ¦­ νƒ€μ…μ„ ν‘ν„ν•  λ• μ¤νƒ€ ν”„λ΅μ μ…μ„ μ“°λ©΄ λλ‹¤.
- μ»΄νμΌλ¬κ°€ κ²½κ³ λ¥Ό ν•λ‹¤λ” μ μ„ μ μ™Έν•λ©΄ μ»΄νμΌ λλ‹¤.

```kotlin
fun printSum(c: Collection<Int>) {
    when (c) {
        is List<Int> -> println("List sum: ${c.sum()}")
        is Set<Int> -> println("Set sum: ${c.sum()}")
    }
}
```

- μ»΄νμΌ μ‹μ μ— νƒ€μ… μ •λ³΄κ°€ μ£Όμ–΄μ§„ κ²½μ°μ—λ” is κ²€μ‚¬ μν–‰μ΄ ν—μ©λλ‹¤.

### π”– 11.2.2 μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” ν•¨μλ” νƒ€μ… μΈμλ¥Ό μ‹¤ν–‰ μ‹μ μ— μ–ΈκΈ‰ν•  μ μλ‹¤

- μΈλΌμΈ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ” μ‹¤μ²΄ν™”λλ‹¤.
  - μ‹¤ν–‰ μ‹μ μ— μΈλΌμΈ ν•¨μμ μ‹¤μ  νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤

```kotlin
inline fun <reified T> isA(value: Any) = value is T

fun main() {
    println(isA<String>("abc"))
    println(isA<String>(123))
}
```

- νƒ€μ… νλΌλ―Έν„°λ¥Ό `reified`λ΅ μ§€μ •ν•λ©΄ `value`μ νƒ€μ…μ΄ Tμ μΈμ¤ν„΄μ¤μΈμ§€λ¥Ό μ‹¤ν–‰ μ‹μ μ— κ²€μ‚¬ν•  μ μλ‹¤.

```kotlin
fun main() {
    val items = listOf("one", 2, "three")
    println(items.filterIsInstance<String>())
}
```

```kotlin
inline fun <reified R, C : MutableCollection<in R>> Iterable<*>.filterIsInstanceTo(destination: C): C {
    for (element in this) if (element is R) destination.add(element)
    return destination
}
```

- `filterIsInstance` ν•¨μλ” μΈμλ΅ λ°›μ€ μ»¬λ ‰μ…μ—μ„ μ§€μ •ν• ν΄λμ¤μ μΈμ¤ν„΄μ¤λ§μ„ λ¨μ•„ λ§λ“  λ¦¬μ¤νΈλ¥Ό λ°ν™

### π”– 11.2.3 ν΄λμ¤ μ°Έμ΅°λ¥Ό μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°λ΅ λ€μ‹ ν•¨μΌλ΅μ¨ java.lang.Class νλΌλ―Έν„° ν”Όν•κΈ°

```kotlin
val serviceImpl = ServiceLoader.load(Service::class.java)
```

- `::class.java` κµ¬λ¬Έμ€ μ½”ν‹€λ¦° ν΄λμ¤μ— λ€μ‘ν•λ” `java.lang.Class` μ°Έμ΅°λ¥Ό μ–»λ” λ°©λ²•μ„ λ³΄μ—¬μ¤€λ‹¤.

```kotlin
val serviceImpl = loadService<Service>()

inline fun <reified T> loadService() {
    return ServiceLoader.load(T::class.java)
}
```

- ν΄λμ¤λ¥Ό νƒ€μ… μΈμλ΅ μ§€μ •ν•λ©΄ ν›¨μ”¬ μ΄ν•΄ν•κΈ° μ‰½λ‹¤.

### π”– 11.2.4 μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°κ°€ μλ” μ ‘κ·Όμ μ •μ

```kotlin
inline val <reified T> T.canonical: String
    get() = T::class.java.canonicalName
```

- μ΄ ν”„λ΅νΌν‹°λ” μ λ„¤λ¦­ ν΄λμ¤μ ν‘μ¤€μ μΈ μ΄λ¦„μ„ λ°ν™ν•λ‹¤.
- ν”„λ΅νΌν‹°λ¥Ό `inline`μΌλ΅ ν‘μ‹ν•κ³  νƒ€μ… νλΌλ―Έν„°λ¥Ό `reified`λ΅ ν•λ©΄ νƒ€μ…μΈμμ— μ“°μΈ κµ¬μ²΄μ μΈ ν΄λμ¤λ¥Ό μ°Έμ΅°ν•  μ μλ‹¤.

### π”– 11.2.5 μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°μ μ μ•½

μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„° μ‚¬μ©ν•  μ μλ” κ²½μ°

- νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν…(is, !is, as, as?)
- 10μ¥μ—μ„ μ„¤λ…ν•  μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API(::class)
- μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” `Java.lang.Class`λ¥Ό μ–»κΈ°(::class, java)
- λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©

μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„° μ‚¬μ©ν•  μ μ—†λ” κ²½μ°

- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±ν•κΈ°
- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ„λ“ νΈμ¶ν•κΈ°
- μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°κΈ°
- ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό `reified`λ΅ μ§€μ •ν•κΈ°

## π“– 11.3 λ³€μ„±μ€ μ λ„¤λ¦­κ³Ό νƒ€μ… μΈμ μ‚¬μ΄μ ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό κΈ°μ 

- λ³€μ„± κ°λ…μ€ κΈ°μ € νƒ€μ…μ΄ κ°™κ³  νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…

### π”– 11.3.1 λ³€μ„±μ€ μΈμλ¥Ό ν•¨μμ— λ„κ²¨λ„ μ•μ „ν•μ§€ νλ‹¨ν•κ² ν•΄μ¤€λ‹¤

```kotlin
fun printContents(list: List<Any>) {
    println(list.joinToString())
}

fun main() {
    printContents(listOf("abc", "bac"))
}
```

- μ„ μ½”λ“λ” μ λ™μ‘ν•λ‹¤.

```kotlin
fun addAnswer(list: MutableList<Any>) {
    list.add(42)
}

fun main() {
    val strings = mutableListOf("abc", "bac")
    addAnswer(strings) // error
    println(strings.maxBy { it.length })
}
```

- `List<Any>`νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— `List<String>`μ„ λ„κΈΈ μ μ—†λ‹¤.
- λ‹¤λ§, μ›μ† μ¶”κ°€λ‚ λ³€κ²½μ΄ μ—†λ” κ²½μ°μ—λ” μ•μ „ν•λ‹¤.

### π”– 11.3.2 ν΄λμ¤, νƒ€μ…, ν•μ„ νƒ€μ…

- μ λ„¤λ¦­ ν΄λμ¤κ°€ μ•„λ‹ ν΄λμ¤μ—μ„λ” ν΄λμ¤ μ΄λ¦„μ„ λ°”λ΅ νƒ€μ…μΌλ΅ μ“Έ μ μλ‹¤.
- λ¨λ“  ν΄λμ¤κ°€ μ μ–΄λ„ λ‘ μ΄μƒμ νƒ€μ…μ„ κµ¬μ„±ν•  μ μλ‹¤.
- μ λ„¤λ¦­ ν΄λμ¤μ—μ„λ” μ¬λ°”λ¥Έ νƒ€μ…μ„ μ–»μΌλ ¤λ©΄ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΈ νƒ€μ… μΈμλ΅ λ°”κΏ”μ¤μ•Ό ν•λ‹¤.
- μ–΄λ–¤ νƒ€μ… Aμ κ°’μ΄ ν•„μ”ν• λ¨λ“  μ¥μ†μ— μ–΄λ–¤ νƒ€μ… Bμ κ°’μ„ λ„£μ–΄λ„ μ•„λ¬΄ λ¬Έμ κ°€ μ—†λ‹¤λ©΄ νƒ€μ… Bλ” νƒ€μ… Aμ ν•μ„ νƒ€μ…μ΄λ‹¤.
- A νƒ€μ…μ΄ B νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λΌλ©΄ Bλ” Aμ μƒμ„ νƒ€μ…μ΄λ‹¤.

```kotlin
fun test(i: Int) {
    val n: Number = i
    
    fun f(s: String) {
        //..
    }
    f(i) // error
}
```

- μ–΄λ–¤ κ°’μ νƒ€μ…μ΄ λ³€μ νƒ€μ…μ ν•μ„ νƒ€μ…μΈ κ²½μ°μ—λ§ κ°’μ„ λ³€μμ— λ€μ…ν•λ„λ΅ ν—μ©ν•λ‹¤.
- ν•μ„ νƒ€μ…μ€ ν•μ„ ν΄λμ¤μ™€ κ·Όλ³Έμ μΌλ΅ κ°™λ‹¤.
- λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ€ λ„μ΄ λ  μ μλ” νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λ‹¤.
- μ–΄λ–¤ μ λ„¤λ¦­ νƒ€μ…(`MutableList`)μ΄ μλ”λ° μ„λ΅ λ‹¤λ¥Έ λ‘ νƒ€μ… Aμ™€ Bμ— λ€ν•΄ `MutableList<A>`κ°€ ν•­μƒ `MutableList<B>`μ ν•μ„ νƒ€μ…λ„ μ•„λ‹κ³  μƒμ„ νƒ€μ…λ„ μ•„λ‹ κ²½μ°μ— μ΄ μ λ„¤λ¦­ νƒ€μ…μ΄ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ λ¬΄κ³µλ³€μ΄λΌκ³  λ§ν•λ‹¤.
  - μλ°”μ—μ„λ” λ¨λ“  ν΄λμ¤κ°€ λ¬΄κ³µλ³€μ΄λ‹¤.

### π”– 11.3.3 κ³µλ³€μ„±μ€ ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€ν•λ‹¤

- κ³µλ³€μ μΈ ν΄λμ¤λ” μ λ„¤λ¦­ ν΄λμ¤(`Producer<T>`)μ— λ€ν•΄ Aκ°€ Bμ ν•μ„ νƒ€μ…μΌ λ• `Producer<A>`κ°€ `Producer<B>`μ ν•μ„ νƒ€μ…μΈ κ²½μ°λ¥Ό λ§ν•λ‹¤.
  - μ΄λ¥Ό "ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€ν•λ‹¤." λΌκ³  λ§ν•λ‹¤.

```kotlin
interface Producer<out T> {
    fun produce(): T
}
```

- μ½”ν‹€λ¦°μ—μ„ μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ κ³µλ³€μ μ„μ„ ν‘μ‹ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ μ•μ— `out`μ„ λ„£μ–΄μ•Ό ν•λ‹¤.
- ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν•¨μ μ •μμ— μ‚¬μ©ν• νλΌλ―Έν„° νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•λ”λΌλ„ κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μ μΈμλ‚ λ°ν™κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
open class Animal {
    fun feed() {
        //
    }
}

class Herd<T: Animal> {
    val size: Int get() = 5
    operator fun get(i: Int): T {
        //
    }
}

fun feedAll(animals: Herd<Animal>) {
    for (i in 0..<animals.size) {
        animals[i].feed()
    }
}
```

- λ¬΄κ³µλ³€ μ»¬λ ‰μ… μ—­ν• μ„ ν•λ” ν΄λμ¤ μ •μμ΄λ‹¤.

```kotlin
class Cat: Animal() {
    fun cleanLitter() {
        //
    }
}

fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0..<cats.size) {
        cats[i].cleanLitter()
    }
    feedAll(cats) // error
}
```

- νƒ€μ… λ¶μΌμΉ μ¤λ¥κ°€ λ‚λ‹¤.
- κ³ μ–‘μ΄ λ¬΄λ¦¬λ” λ™λ¬Ό λ¬΄λ¦¬μ ν•μ„ ν΄λμ¤κ°€ μ•„λ‹κΈ° λ•λ¬Έμ΄λ‹¤.

```kotlin
class Herd<out T: Animal> {
    val size: Int get() = 5
    operator fun get(i: Int): T {
        //
    }
}

fun takeCareOfCats(cats: Herd<Cat>) {
  for (i in 0..<cats.size) {
    cats[i].cleanLitter()
  }
  feedAll(cats)
}
```

- μΊμ¤ν…μ„ ν•μ§€ μ•κ³ λ„ μ—λ¬κ°€ λ°μƒν•μ§€ μ•λ”λ‹¤.
- νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ μ§€μ •ν•λ©΄ ν΄λμ¤ λ‚΄λ¶€μ—μ„ κ·Έ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ„ μ ν•ν•λ‹¤.
- νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ κ³µλ³€μ  νλΌλ―Έν„°λ” ν•­μƒ out μ„μΉμ—λ§ μμ–΄μ•Ό ν•λ‹¤.
  - ν΄λμ¤κ°€ T νƒ€μ…μ κ°’μ„ μƒμ‚°ν•  μλ” μμ§€λ§ μ†λΉ„ν•  μ μ—†λ‹¤λ” λ»
- ν΄λμ¤ λ©¤λ²„λ¥Ό μ„ μ–Έν•  λ• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ§€μ μ€ λ¨λ‘ μΈκ³Ό μ•„μ›ƒ μ„μΉλ΅ λ‚λ‰λ‹¤.
  - ν•¨μμ λ°ν™ νƒ€μ…: μ•„μ›ƒ μ„μΉ
  - ν•¨μμ νλΌλ―Έν„° νƒ€μ…: μΈ μ„μΉ

```kotlin
interface MutableList<T> : List<T>, MutableCollection<T> {
    override fun add(element: T): Boolean
}
```

- `MutableList`λ” Tμ— λ€ν•΄ κ³µλ³€μ μΌ μ μ—†λ‹¤. Tκ°€ μΈ μ„μΉμ— μ“°μ΄κΈ° λ•λ¬Έμ΄λ‹¤.
- μƒμ„±μ νλΌλ―Έν„°λ” μΈμ΄λ‚ μ•„μ›ƒ μ„μΉ μ–΄λ μ½λ„ μ•„λ‹λΌλ” μ‚¬μ‹¤μ— μ μν•μ.
- λ³€μ„±μ€ μ½”λ“μ—μ„ μ„ν—ν•  μ—¬μ§€κ°€ μλ” λ©”μ„λ“λ¥Ό νΈμ¶ν•  μ μ—†κ² λ§λ“¦μΌλ΅μ¨ μ λ„¤λ¦­ νƒ€μ…μ μΈμ¤ν„΄μ¤ μ—­ν• μ„ ν•λ” ν΄λμ¤ μΈμ¤ν„΄μ¤λ¥Ό μλ» μ‚¬μ©ν•λ” μΌμ΄ μ—†κ² λ°©μ§€ν•λ” μ—­ν• μ„ ν•λ‹¤.

```kotlin
class Herd<T: Animal>(var leadAnimal: T, vararg animals: T) {}
```

- `leadAnimal` ν”„λ΅νΌν‹°κ°€ μΈ μ„μΉμ— μκΈ° λ•λ¬Έμ— Tλ¥Ό `out`μΌλ΅ ν‘μ‹ν•  μ μ—†λ‹¤.
- μ΄λ¬ν• μ„μΉ κ·μΉ™μ€ μ™Έλ¶€μ—μ„ λ³Ό μ μλ” APIμ—λ§ μ μ©ν•  μ μλ‹¤.

```kotlin
class Herd<out T: Animal>(private var leadAnimal: T, vararg animals: T) {}
```

- private λ©”μ„λ“μ νλΌλ―Έν„°λ” μΈλ„ μ•„λ‹κ³  μ•„μ›ƒλ„ μ•„λ‹ μ„μΉλ‹¤.
- `Herd`λ¥Ό Tμ— λ€ν•΄ κ³µλ³€μ μΌλ΅ μ„ μ–Έν•΄λ„ μ•μ „ν•λ‹¤.

### π”– 11.3.4 λ°κ³µλ³€μ„±μ€ ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό λ’¤μ§‘λ”λ‹¤

- λ°κ³µλ³€ ν΄λμ¤μ ν•μ„ νƒ€μ… κ΄€κ³„λ” κ·Έ ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°μ μƒν•μ„ νƒ€μ… κ΄€κ³„μ™€ λ°λ€λ‹¤.

```kotlin
sealed class Fruit {
    abstract val weight: Int
}

data class Apple(override val weight: Int, val color: String) : Fruit()

data class Orange(override val weight: Int, val juicy: Boolean) : Fruit()

fun main() {
  val weightComparator = Comparator<Fruit> {
      a, b -> a.weight - b.weight
  }
  val fruits: List<Fruit> = listOf(Apple(100, "green"), Orange(180, true))
  val apples: List<Apple> = listOf(Apple(50, "red"), Apple(120, "green") ,Apple(155, "yellow"))
  println(fruits.sortedWith(weightComparator))
  println(apples.sortedWith(weightComparator))
}
```

- `sortedWith` ν•¨μλ” `Comparator<String>`μ„ μ”κµ¬ν•λ―€λ΅ μΌλ°μ μΈ νƒ€μ…μ„ λΉ„κµν•  μ μλ” `Comparator`λ¥Ό λ„κ²¨λ„ μ•μ „ν•λ‹¤.
- μ–΄λ–¤ νƒ€μ…μ κ°μ²΄λ¥Ό `Comparator`λ΅ λΉ„κµν•΄μ•Ό ν•λ‹¤λ©΄ κ·Έ νƒ€μ…μ΄λ‚ κ·Έ νƒ€μ…μ μ΅°μƒ νƒ€μ…μ„ λΉ„κµν•  μ μλ” `Comparator`λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.
- λ°κ³µλ³€μ„±: μ–΄λ–¤ ν΄λμ¤(`Consumer<T>`)μ— λ€ν•΄ νƒ€μ… Bκ°€ νƒ€μ… Aμ ν•μ„ νƒ€μ…μΌ λ• `Consumer<A>`κ°€ `Consumer<B>`μ ν•μ„ νƒ€μ…μΈ κ΄€κ³„κ°€ μ„±λ¦½ν•λ©΄ μ λ„¤λ¦­ ν΄λμ¤λ” νƒ€μ… μΈμ Tμ— λ€ν•΄ λ°κ³µλ³€μ΄λ‹¤.
- in μ΄λΌλ” ν‚¤μ›λ“λ” κ·Έ ν‚¤μ›λ“κ°€ λ¶™μ€ νƒ€μ…μ΄ μ΄ ν΄λμ¤μ λ©”μ„λ“ μ•μΌλ΅ μ „λ‹¬λΌ λ©”μ„λ“μ— μν•΄ μ†λΉ„λλ‹¤λ” λ»

### π”– 11.3.5 μ‚¬μ© μ§€μ  λ³€μ„±μ„ μ‚¬μ©ν•΄ νƒ€μ…μ΄ μ–ΈκΈ‰λλ” μ§€μ μ—μ„ λ³€μ„± μ§€μ •

- ν΄λμ¤λ¥Ό μ„ μ–Έν•λ©΄μ„ λ³€μ„±μ„ μ§€μ •ν•λ©΄ κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ— λ³€μ„± μ§€μ •μκ°€ μν–¥μ„ λΌμΉλ―€λ΅ νΈλ¦¬ν•λ‹¤.
  - μ„ μ–Έ μ§€μ  λ³€μ„±μ΄λΌκ³  ν•¨.
- μλ°”μ—μ„λ” νƒ€μ… νλΌλ―Έν„°κ°€ μλ” νƒ€μ…μ„ μ‚¬μ©ν•  λ•λ§λ‹¤ κ·Έ νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•μ„ νƒ€μ…μ΄λ‚ μƒμ„ νƒ€μ… μ¤‘ μ–΄λ–¤ νƒ€μ…μΌλ΅ λ€μΉν•  μ μλ”μ§€ λ…μ‹ν•΄μ•Ό ν•λ‹¤.
  - μ‚¬μ© μ§€μ  λ³€μ„±μ΄λΌκ³  ν•¨.

```kotlin
fun <T> copyData(source: MutableList<T>, destination: MutableList<T>) {
    for (item in source) destination.add(item)
}
```

- λ¬΄κ³µλ³€ νλΌλ―Έν„° νƒ€μ…μ„ μ‚¬μ©ν•λ” λ°μ΄ν„° λ³µμ‚¬ ν•¨μ
- λ‘ μ»¬λ ‰μ…μ μ›μ† νƒ€μ…μ΄ μ •ν™•ν•κ² μΌμΉν•  ν•„μ”κ°€ μ—†λ‹¤.

```kotlin
fun <T: R, R> copyData(source: MutableList<T>, destination: MutableList<R>) {
    for (item in source) destination.add(item)
}

fun main() {
    val ints = mutableListOf(1, 2, 3)
    val anyItems = mutableListOf<Any>()
    copyData(ints, anyItems)
    println(anyItems)
}
```

- `int`κ°€ `Any`μ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— μ •μƒ λ™μ‘

```kotlin
fun <T> copyData(source: MutableList<out T>, destination: MutableList<T>) {
  for (item in source) destination.add(item)
}
```

- out ν‚¤μ›λ“λ¥Ό νƒ€μ…μ„ μ‚¬μ©ν•λ” μ„μΉ μ•μ— λ¶™μ΄λ©΄ T νƒ€μ…μ„ in μ„μΉμ— μ‚¬μ©ν•λ” λ©”μ„λ“λ¥Ό νΈμ¶ν•μ§€ μ•λ”λ‹¤λ” λ»
- νƒ€μ… μ„ μ–Έμ—μ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” μ„μΉλΌλ©΄ μ–΄λ””μ—λ‚ λ³€μ„± λ³€κ²½μλ¥Ό λ¶™μΌ μ μλ‹¤.
  - μ΄λ• νƒ€μ… ν”„λ΅μ μ…μ΄ μΌμ–΄λ‚λ‹¤.

```kotlin
fun main() {
    val list: MutableList<out Number> = mutableListOf()
    list.add(42) // error
}
```

- ν”„λ΅μ μ… νƒ€μ… λ€μ‹  μΌλ° νƒ€μ…μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.

```kotlin
fun <T> copyData(source: MutableList<T>, destination: MutableList<in T>) {
    for (item in source) destination.add(item)
}
```

- μ›λ³Έ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μ μƒμ„ νƒ€μ…μ„ λ€μƒ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μΌλ΅ ν—μ©

### π”– 11.3.6 μ¤νƒ€ ν”„λ΅μ μ…: μ λ„¤λ¦­ νƒ€μ… μΈμμ— λ€ν• μ •λ³΄κ°€ μ—†μμ„ ν‘ν„ν•κ³ μ * μ‚¬μ©

- `MutableList<*>`λ” `MutableList<Any?>`μ™€ κ°™μ§€ μ•λ‹¤.
  - `MutableList<*>`λ” μ–΄λ–¤ μ •ν•΄μ§„ κµ¬μ²΄μ μΈ νƒ€μ…μ μ›μ†λ§μ„ λ‹΄λ” λ¦¬μ¤νΈμ§€λ§ κ·Έ μ›μ†μ νƒ€μ…μ„ μ •ν™•ν λ¨λ¥Έλ‹¤λ” μ‚¬μ‹¤μ„ ν‘ν„
  - `MutableList<Any?>`λ” λ¨λ“  νƒ€μ…μ μ›μ†λ¥Ό λ‹΄μ„ μ μμμ„ μ• μ μλ” λ¦¬μ¤νΈλ‹¤.

```kotlin
fun main() {
  val list: MutableList<Any?> = mutableListOf('a', 1, "qwe")
  val chars = mutableListOf('a', 'b', 'c')
  val unknownElements: MutableList<*> = if (Random.nextBoolean()) list else chars
  println(unknownElements.first())
  unknownElements.add(42) // error
}
```

- μ΄ λ§¥λ½μ—μ„ `MutableList<*>`λ” `MutableList<out Any?>`μ²λΌ ν”„λ΅μ μ…λλ‹¤.
- μ›μ† νƒ€μ…μ„ λ¨λ¥΄λ”λΌλ„ μ•μ „ν•κ² μ›μ†λ¥Ό κΊΌλ‚΄μ¬ μλ” μμ§€λ§ νƒ€μ…μ„ λ¨λ¥΄λ” λ¦¬μ¤νΈμ— μ›μ†λ¥Ό λ§μλ€λ΅ λ„£μ„ μλ” μ—†λ‹¤.

```kotlin
fun printFirst(list: List<*>) {
    if (list.isNotEmpty()) {
        println(list.first())
    }
}

fun main() {
    printFirst(listOf("Sveta", "Seb", "Dima", "Roman"))
}
```

- κµ¬μ²΄μ μΈ νƒ€μ…μ„ μ‹ κ²½μ“°μ§€ μ•κ³  μ½κΈ°λ§ ν•  λ• μ¤νƒ€ ν”„λ΅μ μ…μ„ μ“΄λ‹¤.

```kotlin
fun <T> printFirst(list: List<T>) {
    if (list.isNotEmpty()) {
        println(list.first())
    }
}
```

- μ΄ κ²½μ°μ—λ„ λ¨λ“  λ¦¬μ¤νΈλ¥Ό μΈμλ΅ λ°›μ„ μ μλ‹¤.

```kotlin
interface FieldValidator<in T> {
    fun validate(input: T): Boolean
}

object DefaultStringValidator : FieldValidator<String> {
    override fun validate(input: String) = input.isNotEmpty()
}

object DefaultIntValidator : FieldValidator<Int> {
    override fun validate(input: Int) = input >= 0
}

fun main() {
  val validator = mutableMapOf<KClass<*>, FieldValidator<*>>()
  validator[String::class] = DefaultStringValidator
  validator[Int::class] = DefaultIntValidator
}
```

- String νƒ€μ…μ ν•„λ“λ¥Ό `FieldValidator<*>` νƒ€μ…μ κ²€μ¦κΈ°λ΅ κ²€μ¦ν•  μ μ—†κΈ° λ•λ¬Έμ— λ¬Έμ κ°€ μƒκΈ΄λ‹¤.

```kotlin
    val stringValidator = validator[String::class] as FieldValidator<String>
```

- λ…μ‹μ  νƒ€μ… μΊμ¤ν…μ„ μ‚¬μ©ν•λ©΄ μ‚¬μ©ν•  μ μμ§€λ§ warningμ΄ λ°μƒν•λ‹¤.
- λν• κ°’ κ²€μ¦ λ©”μ„λ“ μ•μ—μ„ μ‹¤ν¨ν•λ‹¤.
  - μ‹¤ν–‰ μ‹μ μ— λ¨λ“  μ λ„¤λ¦­ νƒ€μ… μ •λ³΄κ°€ μ§€μ›μ§€κΈ° λ•

```kotlin
fun main() {
    val validator = mutableMapOf<KClass<*>, FieldValidator<*>>()
    val stringValidator = validator[Int::class] as FieldValidator<String>
    stringValidator.validate("") // μ‹¤ν–‰ μ‹μ  μ—λ¬
}
```

- κ²€μ¦κΈ°λ¥Ό μλ» κ°€μ Έμ™”μ§€λ§ μ»΄νμΌμ΄ μ„±κ³µν•λ‹¤.
- κ²°κµ­ μΊμ¤ν…μΌλ΅ ν•΄κ²°ν•λ” κ²ƒμ€ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•  μλ„ μ—†κ³  μ‹¤μλ¥Ό ν•κΈ°λ„ μ‰½λ‹¤.

```kotlin
object Validators {
  private val validators = mutableMapOf<KClass<*>, FieldValidator<*>>()

  fun <T : Any> registerValidator(kClass: KClass<T>, fieldValidator: FieldValidator<T>) {
    validators[kClass] = fieldValidator
  }

  @Suppress("UNCHECKED_CAST")
  operator fun <T : Any> get(kClass: KClass<T>): FieldValidator<T> =
    validators[kClass] as? FieldValidator<T> ?: throw IllegalArgumentException(
      "No validator for ${kClass.simpleName}"
    )
}

fun main() {
  Validators.registerValidator(String::class, DefaultStringValidator)
  Validators.registerValidator(Int::class, DefaultIntValidator)
}
```

- νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•λ” APIμ΄λ‹¤.
- μ΄ ν¨ν„΄μ„ λ¨λ“  μ»¤μ¤ν…€ μ λ„¤λ¦­ ν΄λμ¤λ¥Ό μ €μ¥ν•  λ• μ‚¬μ©ν•  μ μκ² ν™•μ¥ν•  μλ„ μλ‹¤.

### π”– 11.3.7 νƒ€μ… μ„¤λ…

- νƒ€μ… λ³„λ…μ€ κΈ°μ΅΄ νƒ€μ…μ— λ€ν•΄ λ‹¤λ¥Έ μ΄λ¦„μ„ λ¶€μ—¬ν•λ‹¤.
- `typealias` ν‚¤μ›λ“ λ’¤μ— λ³„λ…μ„ μ μ–΄ νƒ€μ… λ³„λ… μ„ μ–Έμ„ μ‹μ‘ν•  μ μλ‹¤.
- κΈ΄ μ λ„¤λ¦­ νƒ€μ…μ„ μ§§κ² λ¶€λ¥Ό λ• μ μ©ν•λ‹¤.

```kotlin
typealias NameCombiner = (String, String, String, String) -> String

val authorsCombiner: NameCombiner = { a, b, c, d -> "$a et al." }
val bandCombiner: NameCombiner = { a, b, c, d -> "$a, $b & The Gang" }

fun combineAuthors(combiner: NameCombiner) {
    println(combiner("Sveta", "Seb", "Dima", "Roman"))
}

fun main() {
    combineAuthors(bandCombiner)
    combineAuthors(authorsCombiner)
    combineAuthors { a, b, c, d -> "$d, $c & Co." }
}
```

- νƒ€μ… λ³„λ…μ„ λ„μ…ν•λ©΄ μ½”λ“λ¥Ό μ½μ„ λ• μΆ€ λ” μ‰½κ² μ΄ν•΄κ°€ λλ„λ΅ ν•¨μν• νƒ€μ…μ— μƒλ΅μ΄ λ§¥λ½μ„ λ¶€μ—¬ν•  μ μλ‹¤.